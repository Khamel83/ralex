#!/bin/bash
# Ralex development environment setup

# Check if virtual environment exists, create if it doesn't
if [ ! -d ".venv" ]; then
    echo "Creating virtual environment..."
    python3 -m venv .venv
fi

# Activate virtual environment
source .venv/bin/activate

# Install dependencies if requirements.txt exists and is newer than last install
if [ -f "requirements.txt" ]; then
    if [ ! -f ".venv/.pip-sync" ] || [ "requirements.txt" -nt ".venv/.pip-sync" ]; then
        echo "Installing/updating dependencies..."
        pip install --upgrade pip
        pip install -r requirements.txt
        pip install -e .
        touch .venv/.pip-sync
    fi
fi

# Set environment variables
export RALEX_ANALYTICS=false
export OPENROUTER_API_KEY="${OPENROUTER_API_KEY:-}"

# Add current directory to Python path
export PYTHONPATH="${PWD}:${PYTHONPATH}"

echo "Ralex development environment ready!"
echo "Run: python -m ralex_core.launcher"